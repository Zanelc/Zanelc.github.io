---
title: 序列号生成算法分析二
categories:
  - [使用Ollydbg从零开始Cracking,xdbg使用]
tags:
  - xdbg基础使用
  - 序列号算法分析
  - 菜鸡逆向
abbrlink: 4c519c4d
date: 2023-08-16 23:41:06
index_img: https://cdn.jsdelivr.net/gh/Zanelc/Zanelc.github.io@main/posts/4c519c4d/title.png
---

序列号生成算法分析--二
<!--more-->

### Mexcrk1

#### 程序分析

使用 **x32dbg** 加载程序，断在入口处。

![入口断点](https://cdn.jsdelivr.net/gh/Zanelc/Zanelc.github.io@main/posts/4c519c4d/image-20230820231927259.png)

查找 **字符串引用** ，可以看到以下字符串。

![字符串引用](https://cdn.jsdelivr.net/gh/Zanelc/Zanelc.github.io@main/posts/4c519c4d/image-20230820232037158.png)

双击跳转到字符串附近，发现 **call** 指令决定后面的 **je** 指令是跳转到 **Thanks you ...** 处还是 **Wrong Code DUDE** 处，在 **call指令** 之前设置断点并运行程序。

![跳转字符串附近](https://cdn.jsdelivr.net/gh/Zanelc/Zanelc.github.io@main/posts/4c519c4d/image-20230820232133913.png)

![输出序列号](https://cdn.jsdelivr.net/gh/Zanelc/Zanelc.github.io@main/posts/4c519c4d/image-20230820232413273.png)

跟进这个 **call** ，函数将我们输入的错误序列号与 **Benadry1** 进行比较。

![比较字符串](https://cdn.jsdelivr.net/gh/Zanelc/Zanelc.github.io@main/posts/4c519c4d/image-20230820233554751.png)

执行到返回，手动将 **ZF** 标志位置1，跳转到 **Thanks you ...** 出，继续运行程序，提示成功。

![提示成功](https://cdn.jsdelivr.net/gh/Zanelc/Zanelc.github.io@main/posts/4c519c4d/image-20230820233655627.png)

**注：** 此处有一个疑问，当查看API调用信息时，发现有导入 **GetWindowTextA** 函数，但是下断点后断不下来。

![API列表](https://cdn.jsdelivr.net/gh/Zanelc/Zanelc.github.io@main/posts/4c519c4d/image-20230820234727709.png)

### Canasta

#### 程序分析

只有当用户输入的用户名和序列号组合正确时 **OK** 按钮才会变为可用。

![注册窗口](https://cdn.jsdelivr.net/gh/Zanelc/Zanelc.github.io@main/posts/4c519c4d/image-20230821000433769.png)

**x32dbg** 加载该程序，断在入口点处，查看 **API函数列表** 和 **字符串列表**。

![API函数列表](https://cdn.jsdelivr.net/gh/Zanelc/Zanelc.github.io@main/posts/4c519c4d/image-20230821000642732.png)

由于 **OK** 按钮不可用，所以我们不能通过单击 **OK** 按钮来获取错误提示是什么，运行程序，然后打开注册按钮，我们运用一些方法来攻击这种保护。

输入 **用户名** ，接着输入序列号

**暂未解决**




